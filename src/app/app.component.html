<div class="cover-container d-flex h-100 p-3 flex-column">
  <main role="main" class="inner h-100 d-flex flex-column">
    
    <div class="form-inline mb-2">
      <button type="button" class="btn btn-dark btn-sm mr-sm-1" (click)="dayBefore()">&lt;</button>
      <button type="button" class="btn btn-dark btn-sm mr-sm-1" (click)="setDate(null)">Today</button>
      <button type="button" class="btn btn-dark btn-sm mr-sm-1" (click)="dayAfter()">&gt;</button>
      <input type="date" name="selectedDate" class="form-control form-control-sm w-auto" [ngModel] ="selectedDate | date:'yyyy-MM-dd'" (change)="datePicker($event);">    
    </div>

    <div class="d-flex align-items-center">
      <div class="flex-grow-1 text-truncate">
        <h4 class="text-truncate">{{activeTask?.name}}</h4>
        <p class="font-weight-bold mb-auto">{{getDurationString(activeTask)}}</p>
      </div>
      <div class="text-right">
        <button *ngIf="activeTask" type="button" class="btn btn-danger" (click)="endTask()">Stop</button>
      </div>
    </div>

    <div class="form-row pt-2 pb-3 pl-1 pr-1">
      <div class="flex-grow-1">
        <input name="taskName" type="text" class="form-control" placeholder="Task name" [(ngModel)]="newTask" (keyup.enter)="switchTask(newTask)">
      </div>
      <div>
        <button *ngIf="!activeTask" type="button" class="ml-2 btn btn-success" (click)="beginTask(newTask)" [disabled]="!newTask">Start</button>
        <button *ngIf="activeTask" type="button" class="ml-2 btn btn-dark" (click)="switchTask(newTask)" [disabled]="!newTask">Switch</button>
      </div>
    </div>

    <div class="row flex-grow-1">
      <div class="col">
        <div class="card h-100">

          <ul *ngIf="!openTask" class="list-group list-group-flush">
            <li class="list-group-item list-group-item-action list-group-item-light d-flex justify-content-between align-items-center" *ngFor="let task of todayTasks">
              <span class="hours">{{task.start | date: 'HH:mm'}} - {{task.end | date: 'HH:mm'}}</span>
              <span class="text-truncate flex-grow-1">{{task.name}}</span>
              <span class="badge badge-dark badge-pill">{{getDurationPill(task)}}</span>
            </li>
          </ul>

          <div *ngIf="openTask" class="card-body">
            <form>
              <div class="form-group row">
                <label class="col-sm-1 col-form-label col-form-label-sm text-right">Task</label>
                <div class="col-sm-11">
                  <input type="text" class="form-control form-control-sm">
                </div>
              </div>
              <div class="form-group row">
                <label class="col-sm-1 col-form-label col-form-label-sm text-right">Start at</label>
                <div class="col-sm-5">
                  <input type="time" class="form-control form-control-sm">
                </div>
                <label class="col-sm-1 col-form-label col-form-label-sm text-right">End at</label>
                <div class="col-sm-5">
                  <input type="time" class="form-control form-control-sm">
                </div>
              </div>
              <div class="form-group row">
                <div class="col text-right">
                  <button type="button" class="btn btn-dark mr-1 btn-sm">Save</button>
                  <button type="button" class="btn btn-danger btn-sm">Delete</button>
                </div>
              </div>
            </form>
          </div>

        </div>
      </div>
    </div>

    <div class="row pt-3 pb-3">
      <div class="col">
      
        <div class="row align-items-center">
          <div class="col">
            <h4>Totals</h4>          
          </div>
          <div class="col-3 text-right">
            <p class="font-weight-bold mb-auto">{{totalHours}}h</p>
          </div>
        </div>
        <div class="totals-overview overflow-auto">
          <div class="row no-gutters" *ngFor="let taskTotal of totals | keyvalue">
            <div class="col-3 text-right text-truncate text-small pr-1">
              {{taskTotal.key}}
            </div>
            <div class="col">
              <div class="progress bg-dark mb-1">
                <div class="progress-bar text-right bg-secondary p-1" role="progressbar" style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100">{{millisToDecH(taskTotal.value.total)}}</div>
              </div>          
            </div>
          </div>
          <!-- <div class="row no-gutters">
            <div class="col-3 text-right text-truncate text-small pr-1">
              Licking bootstrap
            </div>
            <div class="col">
              <div class="progress bg-dark mb-1">
                <div class="progress-bar text-right bg-secondary p-1" role="progressbar" style="width: 83%" aria-valuenow="83" aria-valuemin="0" aria-valuemax="100">1.25</div>
              </div>          
            </div>
          </div>
          <div class="row no-gutters">
            <div class="col-3 text-right text-truncate text-small pr-1">
              Template massaging (with bootstrap 4)
            </div>
            <div class="col">
              <div class="progress bg-dark mb-1">
                <div class="progress-bar progress-bar-striped text-right bg-secondary p-1" role="progressbar" style="width: 83%" aria-valuenow="83" aria-valuemin="0" aria-valuemax="100">1.25</div>
              </div>          
            </div>
          </div>
          <div class="row no-gutters">
            <div class="col-3 text-right text-truncate text-small pr-1">
              Gerbil wrangling
            </div>
            <div class="col">
              <div class="progress bg-dark mb-1">
                <div class="progress-bar text-right bg-secondary p-1" role="progressbar" style="width: 50%" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100">0.75</div>
              </div>          
            </div>
          </div> -->
        </div>
        
      </div>
    </div>

  </main>
</div>